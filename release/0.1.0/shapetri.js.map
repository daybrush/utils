{"version":3,"file":"shapetri.js","sources":["../src/consts.ts","../src/index.ts"],"sourcesContent":["export const TOP = \"top\";\nexport const BOTTOM = \"bottom\";\nexport const LEFT = \"left\";\nexport const RIGHT = \"right\";\nexport type DIRECTION = \"top\" | \"bottom\" | \"left\" | \"right\";\nexport const REVERSE = {\n  [TOP]: BOTTOM,\n  [BOTTOM]: TOP,\n  [LEFT]: RIGHT,\n  [RIGHT]: LEFT,\n};\nexport const TRI_CLASS = \"__shape-tri-\";\nexport const SIDE_CLASS = `${TRI_CLASS}side`;\nexport const POSITION_ABSOLUTE = \"position:absolute;\";\n","import { BOTTOM, TOP, RIGHT, LEFT, REVERSE, DIRECTION, SIDE_CLASS, POSITION_ABSOLUTE, TRI_CLASS } from \"./consts\";\n\nfunction splitUnit(text: string) {\n  const matches = /^([^\\d|e|\\-|\\+]*)((?:\\d|\\.|-|e-|e\\+)+)(\\S*)$/g.exec(text);\n\n  if (!matches) {\n    return { unit: \"\", value: NaN };\n  }\n  const value = matches[2];\n  const unit = matches[3];\n\n  return { unit, value: parseFloat(value) };\n}\n\nfunction getSideCSS(strokeWidth: string, isVertical: boolean) {\n  const x = isVertical ? strokeWidth : \"50%\";\n  const y = isVertical ? \"50%\" : strokeWidth;\n\n  return `${POSITION_ABSOLUTE}width:100%;height:100%;border-radius:inherit;background-color:inherit;` +\n          `transform-origin:${x} ${y};`;\n}\n\nfunction makeDOM(tag: string, className: string) {\n  const el = document.createElement(tag);\n\n  el.className = className;\n  return el;\n}\nexport function dom(el: HTMLElement) {\n  const strokeWidth = el.getAttribute(\"data-stroke-width\") || undefined;\n  const stroke = el.getAttribute(\"data-stroke\") || undefined;\n  const direction = (el.getAttribute(\"data-direction\") as DIRECTION) || undefined;\n  const fill = el.getAttribute(\"data-fill\") || undefined;\n\n  return tri({strokeWidth, stroke, direction, fill, container: el});\n}\nexport function tri({\n  className = `${TRI_CLASS}triangle`,\n  strokeWidth = 0,\n  stroke = \"black\",\n  fill = \"transparent\",\n  direction = BOTTOM,\n  container = makeDOM(\"div\", className),\n}: {\n  strokeWidth: number | string,\n  className?: string,\n  container?: HTMLElement,\n  fill?: string,\n  direction?: DIRECTION,\n  stroke?: string\n}) {\n  const {unit: strokeUnit, value: strokeValue} = splitUnit(`${strokeWidth}`);\n  const half = `${strokeValue / 2}${strokeUnit}`;\n  const isVertical = direction === TOP || direction === BOTTOM;\n  const sideCSS = getSideCSS(half, isVertical);\n  const directionProperty = isVertical ? LEFT : TOP;\n  const sign = direction === TOP || direction === RIGHT ? -1 : 1;\n  const width = isVertical ? \"100%\" : strokeWidth;\n  const height = isVertical ? strokeWidth : \"100%\";\n  // (50% - strokeWidth / 2) * r3 + strokeWidth\n  const padding = isVertical ? `calc(50% * 1.7321 + ${strokeWidth} * 0.132)` :\n  // (100% - strokeWidth) / r3 * 2 + strokeWidth\n    `calc(200% / 1.7321 - ${strokeWidth} * 1.154 + ${strokeWidth})`;\n  const reverseDirection = REVERSE[direction];\n  const sideHTML = `<div class=\"${SIDE_CLASS}1\" style=\"${POSITION_ABSOLUTE}${reverseDirection}: 0;\n  ${directionProperty}:0;display:inline-block;width:${width};height:${height};border-radius:${half};\n  background:${stroke};\"><div class=\"${SIDE_CLASS}2\"\n  style=\"${sideCSS}transform:rotate(${sign * 60}deg);\"></div><div class=\"${SIDE_CLASS}3\"\n  style=\"${sideCSS}${directionProperty}:100%;\n  margin-${directionProperty}:-${strokeWidth};\n  transform:rotate(${sign * 120}deg)\"></div></div><div class=\"${TRI_CLASS}percent\" style=\"position:relative;\n  width:100%;padding-top:${padding};\"\n  ></div>`;\n\n  if (getComputedStyle(container).position === \"static\") {\n    container.style.position = \"relative\";\n  }\n  container.insertAdjacentHTML(\"beforeend\", sideHTML);\n\n  return container;\n}\n\nexport const VERSION = \"#__VERSION__#\";\n"],"names":["TOP","BOTTOM","LEFT","RIGHT","REVERSE","_a","TRI_CLASS","SIDE_CLASS","POSITION_ABSOLUTE","splitUnit","text","matches","exec","unit","value","NaN","parseFloat","getSideCSS","strokeWidth","isVertical","x","y","makeDOM","tag","className","el","document","createElement","dom","getAttribute","undefined","stroke","direction","fill","tri","container","_b","_c","_d","_e","_f","_g","_h","strokeUnit","strokeValue","half","sideCSS","directionProperty","sign","width","height","padding","reverseDirection","sideHTML","getComputedStyle","position","style","insertAdjacentHTML","VERSION"],"mappings":"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"}